# Chapter 3. 네트워크 통신하기

## 3.1 유니캐스트, 멀티캐스트, 브로드캐스트, 애니캐스트

- 유니캐스트
  - 1:1 통신
  - 출발지와 목적지가 1:1 통신
- 브로드캐스트
  - 1:모든 통신
  - 동일 네트워크에 존재하는 모든 호스트가 목적지
- 멀티캐스트
  - 1:그룹 통신
  - 하나의 출발지에서 다수의 특정 목적지로 데이터 전송
- 애니캐스트
  - 1:1 통신
  - 다수의 동입 그룹 중 가장 가까운 호스트에서 응답
  - IPv4에서는 일부 기능 구현, IPv6는 모두 구현 가능
  - 가장 가까운 게이트웨이를 찾는 기능에도 사용
    - Kakao https://tech.kakao.com/posts/307

**BUM(Broadcast, Unknown Unicast, Muticast) 트래픽** -> 불필요한 트래픽이 많아지면 네트워크 성능 저하 but, 이더넷 환경에서는 ARP 브로드캐스트를 먼저 보내고 통신하기 때문에 BUM 트래픽이 많이 발생하지 않음

## 3.2 MAC 주소

2계층에서 통신을 위해 NIC에 할당된 고유 식별자 (이더넷, 와이파이 포함한 IEEE 802 네트워크 기술에서 사용)

## MAC 주소 체계
- 변경할 수 없도록 하드웨어 고정되어 출하
- 48비트 16진수 12자리 -> OUI 24비트, UAA 24비트. OUI는 IEEE가 할당
- BIA(Burned-In Address)라고도 부름

## MAC 주소 동작
패킷으로 변환하여 도착지 MAC 주소 확인

**무차별 모드 (Promiscuous Mode)**
다른 목적지를 가진 패킷을 분석하거나 수집해야하는 경우, 무차별 모드로 NIC를 구성함.
자신의 MAC 주소와 상관없는 패킷이 들어와도 이를 분석할 수 있도록 메모리에 올려 처리할 수 있게 함 (Wireshark)

## 3.3 IP 주소
3계층 주소 특징
1. 사용자가 변경 가능한 논리 주소
2. 주소에 레벨이 있음. 그룹을 의미하는 네트워크 주소와 호스트 주소로 나뉨

### IP 주소 체계
IPv4 : 32비트 / IPv6 : 128비트

- 네트워크 주소 : 네트워크 주소가 동일한 네트워크를 로컬 네트워크라고 함
- 호스트 주소 : 호스트 구분하기 위한 주소

네트워크, 호스트 주소를 구분하는 경계점이 고정되어 있지 않음.
필요한 호스트 IP 개수에 따라 네트워크 크기를 다르게 할당할 수 있는 Class 개념을 도입
현재는 사용하지 않고 있음. 현재는 더 세밀하게 분할, 할당하기 위해 1 bit 단위로 네트워크를 상세히 분할
- A 클래스 : 약 1600만 개
- B 클래스 : 약 65000개
- C 클래스 : 약 250개

***IP 체계에서 맨 앞의 숫자를 네트워크 주소로, 맨 뒤의 숫자를 브로드캐스트 주소로 사용하기 때문에 각 클래스에서 -2해야 함***

### 클래스풀과 클래스리스

IP 주소 부족과 낭비 문제
1. 단기 대책 : 클래스리스(CIDR)
2. 중기 대책 : NAT, private IP
3. 장기 대책 : IPv6

네트워크 주소와 호스트 주소의 경계점/구분자 -> 서브넷 마스크
255.0.0.0 == /8
255.255.0.0. == /16
255.255.255.0 == /24

### 서브네팅(Subnetting)
- 네트워크 사용자 입장 : 네트워크에서 사용할 수 있는 IP 범위 파악
- 네트워크 설계자 입장 : 네트워크 범위 설계

### 네트워크 사용자 입장
유효 범위 파악
1. 내 IP를 2진수로 표현
2. 서브넷 마스크를 2진수로 표현
3. 2진수 AND 연산으로 서브네팅된 네트워크 주소를 알아낸다
4. 호스트 주소 부분을 2진수 1로 모두 변경해 브로드캐스트 주소를 알아낸다
5. 유효 IP 범위를 파악한다. 서브네팅된 네트워크 주소 +1은 유효 IP 중 가장 작은 IP다
6. 브로드캐스트 주소-1은 유효 IP 중 가장 큰 IP다
7. 2진수로 연산되어 있는 결괏값을 10진수로 변환한다

### 네트워크 설계자 입장
- 서브넷된 하나의 네트워크에 몇 개의 IP를 할당해야 하는가?
- 서브넷된 네트워크는 몇 개 필요한가?

잘 설계된 네트워크는 관리하기 쉽고, 네트워크 장비 성능도 향상됨.

### Public IP와 Private IP

사설 네트워크 -> NAT -> Public IP -> 인터넷

**IANA가 여러 목적으로 예약해두어 공인 IP로 할당하지 않는 주소 Bogon IP**

## 3.4 TCP와 UDP

정확한 주소 제공이 목적인 2, 3계층과 다르게 4계층은 1/ 목적지 프로세스를 정확히 찾아가고, 2/ 패킷 순서가 바뀌지 않도록 조합해 3/ 원래 데이터를 잘 만드는 것이 목적
포트 번호를 Source, Destination으로 구분해서 사용

### TCP



