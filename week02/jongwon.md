```toc
```

# 2장 네트워크 연결과 구성 요소
## 2.1 네트워크 연결 구분
- 규모와 관리 범위에 따라 구분됨
	- LAN(Local Area Network)
		- 사용자 내부 네트워크
	- MAN(Metro Area Network)
		- 한 도시 정도를 연결하고 관리하는 네트워크
	- WAN(Wide Area Network)
		- 멀리 떨어진 LAN을 연결해주는 네트워크
- 예전에는 LAN, MAN, WAN 따라 기술이 모두 달라 구분할 수 있었지만 지금은 대부분의 기술이 이더넷으로 통합되면서 사용자가 기술을 구분하는 것은 무의미. 따라서 관리 범위 기준으로 구분함
	- MAN은 수~수십 KM 범위
	- 일반적으로 도시 단위의 네트워크를 구분할 대 통신사가 이미 갖고있는 인프라 기반으로 구축하면 WAN, 자체 인프라 통해 구축하면 MAN으로 구분하기도 함


### 2.1.1 LAN
- 홈, 사무실처럼 비교적 소규모 네트워크
- 먼 거리를 통신할 필요가 없어 스위치 같이 비교적 간단한 장비로 연결된 네트워크를 LAN으로 불러왔다
- 현재는 대부분 이더넷 기반


- 관리 범위를 생각하면 LAN은 자신이 소유한 건물이나 대지에 직접 구축한 선로로 동작시키는 네트워크로 정의할 수 있었음
- 과거는 대규모 공장이나 대학과 같은 광범위한 네트워크 별도로 구분했지만 지금은 무의미

### 2.1.2 WAN
- 먼 거리에 있는 네트워크 연결에 사용
- WAN은 특별한 경우가 아니면 직접 구축할 수 없는 범위의 네트워크로 대부분 통신사업자로부터 회선을 임대해서 사용

![](files/Pasted%20image%2020250223181027.png)

## 2.2 네트워크 회선
- 원격지 네트워크 연결에는 WAN 필요
- 예전에는 다양했지만 지금은 LAN처럼 이더넷 주로 사용
- 일반적인 이더넷 외에 특별한 용도로 음성 회선 기반의 저속 회선 기술이나 통신사업자 간의 고속 통신 또는 가입자 식별 용도로 다양한 기술 쓰기도 함
### 2.2.1 인터넷 회선
- 인터넷 접속을 위해 통신사업자와 연결하는 회선을 인터넷 회선이라고 부름
- 일반 가정에서 인터넷에 연결하기 위해 사용하는 기술은 인터넷 전용 회선이랑은 조금 다름
- 가입자와 통신사업자가 직접 연결되는 게 아니라 전송 선로 공유 기술을 사용함
	- 아파트가 연결한 회선을 서로 공유하는 구조
	- 즉, 주변 사용량에 따라 느려질 수도 있음

### 2.2.2 전용 회선
- 가입자와 통신사업자 간에 대역폭을 보장해주는 서비스를 대부분 전용 회선이라고 부른다
- 여러 기술이 있지만 가입자와 통신사업자 간에 전용 케이블로 연결되어 있고 통신사업자 내부에서 TDM(Time Division Multiplexing) 같은 기술로 직접 연결한 것처럼 통신 품질 보장해줌

- 전용 회선을 가입자와 접속하는 전송 기술로 구분하면 아래처럼 음성 전송 기술 기반의 저속 회선과 메트로 이더넷이라는 고속 회선으로 구분 가능
	- 저속 : 음성 전송 기술 기반
		- 64kbs 단위로 구분해서 사용
		- 작은 기본 단위를 묶어 회선 접속 속도를 높이는 방법으로 오랫되어 사용되어 옴
		- 높은 속도가 필요하지 않거나 높은 신뢰성이 필요할 대 사용되어 왔지만 현재는 이더넷이 발전해 사용 빈도가 줄어들고 있다
		- 결재 승인과 같은 전문 전송을 위한 VAN(Value Added Network)사나 대외 연결에는 저속 회선을 사용하는 경우가 많다.
		- 이 기술을 사용하려면 원격지 전송 기술로 변환할 수 있는 라우터가 필요하다.
	- 고속 : 메트로 이더넷
		- 대부분 광케이블 기반 이더넷
		- 가입자와 통신사업자 사이에는 이더넷 사용하고
		- 통신 사업자 내부에는 이런 개별 가입자를 묶어 통신할 수 있는 다른 고속 통신 기술 사용
			- 통신 사업자는 여러 가입자를 구분하고 가입자 트래픽을 고속으로 전송하는 것이 중요하기 때문
			- 다양한 가입자 접속 기술을 하나의 기술로 통합하기 위한 기술이 사용됨

- LLCF(Link Loss Carry Forward)
	- 한쪽 링크가 다운되면 이를 감지해 반대쪽 링크도 다운시키는 기능
	- 전용 회선을 이더넷으로 구성할 때 LLCF 설정 안 하면 전용 회선이 한 사이트에서 다운되더라도 반대쪽 사이트에서는 회선이 그대로 살아있는 것처럼 보이므로 회선 개통 후 LLCF 설정 되어있는지 확인 필요
	- 저속 회선은 2계층 프로토콜 통신 상태를 확인하는 기능이 있어 LLCF 설정이 별도로 필요 없음

![](files/Pasted%20image%2020250223181803.png)
> LLCF가 설정된 장비를 기준으로하여 **위, 아래 link 중 어느 하나가 끊어지면(down state) 나머지 하나의 link도 끊어**서 위, 아래 위치된 **장비의 경로 설정을 변경(Failover)할 수 있도록 해주는 네트워크 기술**

- dynamic routing을 사용하는 경우 일시적 순단만 발생

- 잘 모르겠지만 찾아본 것들..
	- 이더넷
		- Ethernet 전용회선은 상대적으로 고속 전송 특성을 가지고 있고, 양쪽 사이트에서 별도로 링크 상태를 감지합니다.  
		- 만약 한쪽 사이트에서 장애가 발생하면 그 쪽에서는 링크 다운을 인지하지만, 반대쪽에서는 여전히 링크가 살아있는 것처럼 보일 수 있습니다.  
		- 이때, 네트워크 장비나 상위 프로토콜은 "연결이 끊긴 것으로 판단해야 하는데" 반대쪽에서는 정상 상태로 인식되면 혼란이 발생할 수 있습니다.  
		- LLCF(Link Loss Carry Forward) 기능은 한쪽에서 링크 장애가 감지되면, 그 상태를 반대쪽으로도 전달하여 양쪽 모두가 동일하게 장애 상태로 인식하도록 강제합니다.  
		- 따라서 Ethernet 전용회선에서는 서로 다른 양쪽 장비가 동일한 인식 상태를 갖도록 하기 위해 LLCF가 필수적입니다.
	- 저속 회선
		- 저속 회선에서는 전송 속도가 느리고 데이터량이 적어, 라우터나 기타 장비에서 자체적으로 링크 장애를 감지하고 처리할 수 있는 메커니즘이 포함되어 있는 경우가 많습니다.  
		- 또한, 저속 회선은 전용 회선 구성 구조나 전송 프로토콜상에서 사용되는 신호나 상태 변화가 명확하게 감지되어, 별도의 LLCF 기능 없이도 장애를 정확하게 판단할 수 있습니다.  
		- 그래서 저속 회선은 LLCF 없이도 각 끝에서 장애 상황을 적절하게 감지하여 대응이 가능합니다.

### 2.2.3 인터넷 전용 회선
- 통신 대역폭을 보장해주는 상품을 인터넷 전용 회선이라고 한다
- 가정과 달리 다른 가입자와 경쟁하지 않고 통신사업자와 가입자 간의 연결 품질을 보장해준다
- 기존에는 인터넷 전용 회선과 일반 가정 가입자가 사용하는 네트워크 기술이 큰 차이가 있었지만 요즘은 대부분 광 접속 기술을 써서 구분이 어렵다
- 인터넷 전용 회선에는 이더넷이 많이 쓰인다
- 메트로 이더넷은 수~수십 km까지 전송할 수 있는 최근의 이더넷 기술을 바탕으로 하고 있다
	- 100% 광케이블
	- 내부에서 다른 네트워크 연동이 필요 없이 LAN만 쓰면 되므로 비용 효율적?

### 2.2.4 VPN
- Virtual Private Network
- 물리적으로 전용선은 아니지만 가상으로 직접 연결한 것 같은 효과

#### 2.2.4.1 통신사업자 VPN
- 전용선은 거리가 늘어날수록 비쌈
- 대역폭 보장해주지만 항상 100% 쓰는 게 아니라면 낭비되는 비용이 클 수 있음
- 이를 위해 통신사업자가 직접 가입자를 구분할 수 있는 VPN 기술을 사용해 비용을 낮추고 있다
	- 대표적인 게 MPLS VPN

![](files/Pasted%20image%2020250223183030.png)

- 여러 가입자가 하나의 망에 접속해 통신하므로 비용 절약
- 전용 회선은 거리에 영향받지만 MPLS VPN 회선은 속도의 영향을 받으므로 거리가 멀수록 MPLS 같은 공용망 기술이 비용 낮추는 데 큰 도움이 된다.
- 도시 내부 통신 외에 본사-지사, 지사-지사 간의 연결은 대부분 MPLS 사용
- 가입자 입장에서는 특별히 고려할 게 없으므로 일반 전용선 연결과 동일한 접속 기술 사용

#### 2.2.4.2 가입자 VPN
- 일반 사용자가 VPN 사용하면 대부분 이것
- 일반 인터넷 망 이용해서 직접 가상 전용 네트워크 구성
- 지방이나 해외를 전용선 연결하면 너무 비싸고, MPLS VPN 사용한 회선도 일반 인터넷보단 비쌈
- 그래서 더 비용을 낮추기 위해 일반 인터넷 연결을 이용한 VPN 사용
- 자세한 건 뒤에서

![](files/Pasted%20image%2020250223183412.png)


### 2.2.5 DWDM
- Dense Wavelength Division Multiplex
- 먼 거리를 통신할 때 케이블 포성 비용이 비싸고, 관리가 어려워 나온 기술
- WDM 전에는 하나의 광케이블에는 하나의 통신만 가능했음
- WDM, DDM은 하나의 광케이블에 다른 파장의 빛을 통해 여러 채널을 만드는 동시에 많은 데이터 전송 가능

![](files/Pasted%20image%2020250223183938.png)

- DWDM은 기존 WDM보다 더 많은 채널을 이용하는 기술
- 통신사업자 내부에서 쓰이던 기술이지만 요즘은 일반 가정에서 사용하는 기가 인터넷에서도 사용된다

- 기가 인터넷은 TTH(Fiber To The Home)가 사용되고 구축 방식에 따라 PTP, AON, PON 형태로 구분
- PTP(Point-to-Point) 방식은 가입자와 통신사업자 간에 케이블을 직접 포설
- AON(Active Optical Network)은 광신호 분리장비에 전기가 필요한 스위치와 같은 장비 사용
- PON 기술은 전기 인입 없이 광신호를 분리해 가입자와 통신사업자 간의 케이블 줄일 수 있음
- 가입자들은 하나의 회선 공유하므로 인터넷 속도가 느려질 수 있는데 DWDM 기술을 사용하면 가입자마다 별도의 채널을 사용하므로 인터넷 접속 속도를 유지할 수 있다

## 2.3 네트워크 구성 요소
### 2.3.1 네트워크 인터페이스 카드(NIC)
- 흔히 랜카드라 불리는 부품의 정식 명칭은 Network Interface Card(NIC)
	- Network Card, Network Interface Controller
- 컴퓨터를 네트워크에 연결하기 위한 하드웨어 장치

- 노트북, 데스크톱 PC, 서버도 온브드 형태로 네트워크 인터페이스 카드가 장착되므로 추가 필요 X
- 서버의 경우 여러 네트워크에 동시에 연결되어야 하거나 추가로 높은 대역폭이 필요한 경우 네트워크 인터페이스 카드를 추가

- 주요 역할
	- 직렬화
		- 전기 신호 <-> 데이터 신호
		- 네트워크 카드 외부 케이블에서는 전기 신호 형태로 데이터 전송됨
	- MAC 주소
		- MAC 주소를 가짐
		- 자기 MAC 주소 아니면 버리고 맞으면 올려보냄
	- 흐름 제어(Flow Control)
		- 다양한 통신이 하나의 채널을 사용하므로 이미 통신 중인 데이터 처리 떄문에 새로운 데이터를 받지 못할 수 있음
		- 데이터 유실 방지를 위해 데이터를 받지 못할 때는 상대에게 통신 중지를 요청할 수 있음

- 다양한 네트워크 카드
	- 서버나 네트워크 장비 등에서는 높은 신뢰도와 대역폭을 위해 광케이블을 이용한 인터페이스 카드 사용
	- 단순히 높은 대역폭 제공은 물론 CPU에 부하가 걸리지 않도록 CPU 도움 없이 패킷 생성 및 전송
	- 일부 NIC는 L3 스위치 기능이 내장되어 가상화 서버끼리 연결하는 vSwitch를 가속하는 기능도 제공
	- 이런 다양한 기능과 높은 대역폭 지닌 NIC는 서버 가상화와 네트워크 장비를 가상화하는 NFV(Network Function Virtualizaiton)에 사용됨

- Multifunction NIC
	- 이더넷뿐만 아니라 스토리지와 서버를 연결하는 SAN(Storage Area Network) 구성용 Fibre Channel 표준이 있고 이더넷에서 스토리지 네트워크를 구성하기 위한 iSCSI 프로토콜도 있다
	- 슈퍼컴퓨터처럼 여러 대의 서버를 묶어 고성능 클러스터링을 구현할 수 있는 HPC 네트워크에는 인피니밴드 기술이 사용됨
	- 다양한 프로토콜이 이더넷 기반으로 변화하고 있지만 여전히 다양한 프로토콜이 사용되며 특수 네트워크를 지원하고 가속할 수 있는 네트워크 카드도 사용됨

### 2.3.2 케이블과 커넥터
- 트위스티드 페어 케이블, 동축 케이블, 광케이블 3가지
- 거리나 속도에 따라 다양하고 용도에 맞게 사용

#### 2.3.2.1 이더넷 네트워크 표준
- 대중화된 이더넷 표준은 기가비트 이더넷과 10기가비트 이더넷
- 서버와 스위치 간 연결을 10기가비트 이더넷으로 구성하면 스위치에서는 상위 스위치와의 연결을 위한 업링크 대역폭 확보를 위해 40기가비트나 100기가비트 이더넷을 사용

![](files/Pasted%20image%2020250223185236.png)

- 케이블 종류, 인코더 종류 등으로 세분화 해 여러 표준으로 나뉘지만 대중적으로 많이 쓰이는 건 3개다

- 1,000BASE-T / 10GBASE-T
	- 트위스티드 페어 케이블 사용하는 기가 인터넷 표준
- 1,000BASE-SX / 10GBASE-SR
	- 멀티모드 광케이블 사용하고 비교적 짧은 거리 보낼 수 있는 이더넷 표준
- 1,000BASE-LX / 10GBASE-LR
	- 싱글모드 광케이블 사용하고 비교적 긴거리 보낼 수 있는 표준

- 1,000BASE-T
	- 1,000 : 1,000Mbps 속도
	- Base : 단일 채널 통신
	- Broad : 다채널 토신
	- T : 케이블 종류. 트위스티드 페어 케이블
		- 이에 따라 케이블, 광신호, 트랜시버 달라짐

#### 2.3.2 케이블, 커넥터 구조
![](files/Pasted%20image%2020250223185525.png)

- 트랜시버, 커넥터, 케이블 모두 분리된 것도 있고 하나로 합쳐진 것도 있다
- 트위스티드 페어 케이블은 커넥터와 케이블 본체가 하나로 구성되어있고 별도의 트랜시버가 없는 경우가 많다
- 광케이블은 다양한 속도와 거리를 지원해야 하므로 트랜시버, 커넥터와 케이블 모두 분리하는 경우가 많다

#### 2.3.2.3 케이블 - 트위스티드 페어 케이블
- 쉴드가 있는 STP/FTP
- 쉴드가 없는 UTP

- RJ-45 커넥터를 이용하고 케이블 본체와 함께 연결되어 분리할 수 없다

- 속도, 거리에 따라 다양한 스펙 존재
- 카테고리 단위로 등급을 나눈다
	- 5E, 6, 6A, 7 등등

- 그물 형태의 쉴드가 있는 STP(Shielded Twisted Pair)
- 포일 형태의 쉴드가 있는 FTP(Foiled Twisted Pair)
- 쉴드가 없는 UTP(Unshielded Twisted Pair)

![](files/Pasted%20image%2020250223190225.png)

- UTP는 커넥터와 케이블 본체가 방향이 고정된 상태로 조립되어 뒤집거나 분리할 수 없다
- 이런 고정 케이블을 쉽게 연결하기 위해 단말 장비인 PC, 서버와 네트워크 장비인 스위치는 회로 모양이 서로 다르다
- 따라서 UTP 케이블 연결할 때는 연결하는 장비나 회로 모양 고려 필요
- 1,000BaseT 이상을 지원하는 NIC는 대부분 자동으로 회로 모양 감지해주는 Auto MDIX 제공하므로 고려 필요 X

 - 광케이블은 UTP와 달리 커넥터를 뒤집을 수 있어 스트레이트와 크로스 구분이 없는 한 가지 케이블만 있다

#### 2.3.2.4 케이블 - 동축 케이블
- 케이블 TV 연결 등에 사용
- 과거에는 LAN 구간에도 쓰였지만 다루기 힘들고 고가라 잘 사용되지 않고 케이블 TV나 인터넷 연결에만 사용
- 최근 10G 이상의 고속 연결을 위해 트랜시버를 통합한 DAC(Direct Attach Copper Cable) 케이블을 많이 사용하는데 이 케이블은 동축케이블이다

#### 2.3.2.5 케이블 - 광케이블
- 신뢰도가 높고 더 먼거리 통신 가능
- 광신호는 저항으로 인한 감쇄나 주위 자기장 간섭으로부터 비교적 자유로움

- 싱글 모드, 멀티 모드 존재
- 싱글 모드는 먼 거리 통신 지원을 위해 케이블 굵기가 매우 가늘고 레이저 사용
	- 레이저는 다른 광원에 비해 퍼지지 않고 직진
- 멀티 모드는 비교적 굵은 케이블 사용, LED 사용
	- LED는 레이저보다 저렴

- 넓은 광 전송로에 여러 가지 광원이 전송되므로 멀티모드라고 하고 하나의 레이저 신호로 가느다란 전송로를 통과하므로 싱글모드라고 부른다
- 반사 각도가 작은 싱글 모드가 훨씬 먼 거리 전송 가능
#### 2.3.2.6 커넥터
- 네트워크 장비나 네트워크 카드에 연결되는 부분
- 트위스티드 페어 케이블은 RJ-45 커넥터 사용하지만 광케이블은 다양한 커넥터 존재
	- 광케이블은 주로 LC 커넥터 사용되고 SC 커넥터가 일부 사용됨

#### 2.3.2.7 트랜시버
- 다양한 외부 신호를 컴퓨터 내부 전기 신호로 바꿈
- 트랜시버가 없을 때는 다양한 이더넷 표준과 케이블 만족을 위해서 별도의 네트워크 장비나 NIC 구매 필요

- 트랜시버 중 하나는 GBIC은 초기 개발된 모듈 이름이고 나중에 SPF나 SPF+ 같이 상위 표준이 나왔지만 GBIC로 통칭해 부름
	- GBIC(GigaBit Interface Converter) : SC 타입 연결
	- SFP(Small Form-Factor Pluggable) : LC 타입 연결
- 트랜시버는 광케이블뿐만 아니라 트위스티드 페어 케이블도 수용할 수 있으며, 이런 트랜시버를 GLC-TE라고 부른다

![](files/Pasted%20image%2020250223190952.png)

- 트랜시버 없이 전용 인터페이스 사용하면 길이나 속도마다 다른 네트워크 장비나 NIC 구매해야 하지만 간단히 트랜시버만 변경하면 통신 길이와 속도 조절할 수 있어 대부분의 네트워크 장비와 NIC는 트랜시버를 지원한다.

- 다양한 케이블 종류
	- DAC(Direct Attach Copper Cable) / AOC(Active Optical Cable)
	- Break-Out 케이블
	- MPO(Mutiple-Fiber Push-On/Pull-Off)

### 2.3.3 허브
- 케이블과 동일하게 1계층 동작 장비
- 거리가 멀어질수록 줄어드는 전기 신호를 재생성, 여러 대의 장비 연결 목적
- 단순히 들어온 모든 신호를 모든 포트로 내보내 네트워크에 접속된 모든 단말이 경쟁하게 되므로 네트워크 성능이 줄어드는 문제가 있고 패킷이 무한 순환해 네트워크 전체를 마비시키는 루프와 같은 장애 원인이 되어 거의 사용되지 않음

### 2.3.4 스위치
- 허브와 동일하게 여러 장비를 연결하고 통신을 중재하는 2계층 장비
- 허브와 스위치는 동작 방식이 다르지만 여러 장비를 연결하고 케이블을 한 곳으로 모아주는 역할을 하므로 허브라는 용어를 공통적으로 사용함
- 허브와 통신 중재 모두 수행하므로 스위칭 허브라고도 부름

- 스위치는 허브와 달리 MAC 주소를 이해해 목적지가 연결된 포트에만 전기 신호를 보낸다

![](files/Pasted%20image%2020250223191358.png)

- 스위치의 발명과 대중화는 효율이 낮고 네트워크 응답 성능을 보장할 수 없었던 이더넷 네트워크가 성능 보장이 가능한 효율 높은 네트워크 기술로 발전하는 계기가 되었다

### 2.3.5 라우터
- 3계층에서 동작, 먼 거리로 통신할 수 있는 프로토콜로 변환

- 라우터는 원격지로 쓸데없는 패킷이 전송되지 않도록 브로드캐스트와 멀티캐스트를 컨트롤하고 불분명한 주소로 통신을 시도할 경우 이를 버린다
- 정확한 방향으로 패킷이 전송되도록 경로를 지정하고 최적의 경로로 패킷 포워딩

### 2.3.6 로드 밸런서
- 일반적으로 4계층에서 동작
- 애플리케이션 프로토콜을 이해하는 7계층 LB를 별도로 ADC(Application Delivery Controler)라고 부른다
- L4 스위치라고 부르는 네트워크 장비도 로드 밸런서의 한 종류로 스위치처럼 여러 포트를 가지고 있으면서 로드 밸런서 역할을 하는 장치를 지칭한다.

- LB는 4계층 포트 주소를 확인하는 동시에 IP주소를 변경할 수 있다
- 웹 서버에 많이 쓰임
	- 대표 IP는 로드밸런서가 가지고 각 웹서버로 패킷의 목적지 IP 주소를 변경해줌
- 이런 기능을 위해 LB는 IP 변환 외에도 서비스 헬스 체크 기능이나 대용량 세션 처리 기능이 있다.

### 2.3.7 보안 장비(방화벽/IPS)
- 보안 장비는 정보를 잘 제어하고 공격을 방어하는 데 초점
- 방어 목적과 설치되는 위치에 맞추어 다양한 보안 장비가 사용됨
- 가장 유명한 보안 장비는 방화벽
	- 4계층에서 동작해 패킷의 3,4 계층 정보를 확인해 버리거나 포워딩

### 2.3.8 기타(모뎀/공유기 등)
- 공유기는 2계층 스위치, 3계층 라우터, 4계층 NAT와 간단한 방화벽 기능을 한곳에 모아놓은 장비
- 스위치 부분, 무선 부분, 라우터 부분으로 나뉜다
	- 겉으로는 하나의 장비로 보이지만 내부적으로는 스위치, 무선 API, 라우터 부분으로 구분되는 복잡한 장비

 - 모뎀은 짧은 거리를 통신하는 기술과 먼 거리를 통신하는 기술이 달라 이를 변환해주는 장비

- 공유기의 LAN 포트와 WAN 포트는 모두 일반 이더넷이라 100m 이상의 먼 거리로 데이터를 보내지 못하므로 먼 거리 통신이 가능한 기술로 변환해주는 모뎀이 필요
- 기가 인터넷의 경우 FTTH 모뎀을 사용하고 동축 케이블 인터넷은 케이블 모뎀, 전화선을 이용할 경우 DSL, VDSL 모뎀이 사용된다


